# راهنمای پیکربندی

تمام تنظیمات شیرازه از طریق یک فایل جاوااسکریپت به نام `config/config.js` مدیریت می‌شود. این فایل به شما اجازه می‌دهد تا جنبه‌های مختلف ویکی، از مسیر فایل‌ها گرفته تا رنگ‌بندی را به سادگی شخصی‌سازی کنید.

فایل `config.js` به صورت پیش‌فرض شامل تمام گزینه‌های ممکن است. شما فقط باید مقادیر گزینه‌هایی را که می‌خواهید تغییر دهید، ویرایش کنید. اگر گزینه‌ای را حذف کنید، مقدار پیش‌فرض آن استفاده خواهد شد.

## بررسی گزینه‌ها

در ادامه، هر بخش از فایل تنظیمات به تفصیل توضیح داده می‌شود.

### `appName`
نام ویکی شما که در هدر سایدبار و عنوان تب مرورگر نمایش داده می‌شود.

-   **مقدار پیش‌فرض:** `'شیرازه'`
-   **مثال:**
    ```javascript
    appName: 'مستندات پروژه من'
    ```

### `basePath`

این گزینه مسیر پایه ویکی شما را مشخص می‌کند. اگر پروژه شما مستقیماً در ریشه یک دامنه قرار دارد، مقدار پیش‌فرض `.` مناسب است. اما اگر آن را در یک زیرپوشه (مثلاً `example.com/docs/`) قرار داده‌اید، باید این مقدار را تنظیم کنید.

-   **مقدار پیش‌فرض:** `'.'`
-   **مثال:**
    ```javascript
    basePath: 'my-wiki-docs'
    ```

### `files`

این بخش مسیر فایل‌های اصلی پروژه را تعیین می‌کند. تمام مسیرها نسبت به `basePath` در نظر گرفته می‌شوند.

-   `sidebar`: فایل مارک‌داونی که ساختار منوی کناری را تعریف می‌کند.
-   `defaultPage`: فایلی که به عنوان صفحه اصلی (وقتی کاربر آدرس ریشه را باز می‌کند) نمایش داده می‌شود.
-   `notFoundPage`: فایلی که در صورت پیدا نشدن یک صفحه (خطای 404) نمایش داده می‌شود.

-   **مقدار پیش‌فرض:**
    ```javascript
    files: {
      sidebar: 'config/sidebar.md',
      defaultPage: 'README.md',
      notFoundPage: 'config/404.md'
    }
    ```

### `markdown`
این بخش به شما اجازه می‌دهد تا مفسر مارک‌داون مورد استفاده در پروژه را تعیین و شخصی‌سازی کنید.

-   `parser`: نام یک مفسر داخلی (مانند `'parsneshan'`) یا یک آبجکت برای تعریف یک مفسر سفارشی.
-   `parserOptions`: یک آبجکت برای ارسال تنظیمات به مفسر. این بخش برای افزودن افزونه به مفسر پیش‌فرض (پارس‌نشان) بسیار کاربردی است.

-   **مقدار پیش‌فرض:**
    ```javascript
    markdown: {
      parser: 'parsneshan',
      parserOptions: {
        plugins: []
      }
    }
    ```
-   **مثال (برای افزودن افزونه‌های markdown-it):**
    ```javascript
    // توجه: ابتدا باید فایل CDN افزونه‌ها را در index.html اضافه کنید
    markdown: {
      parser: 'parsneshan',
      parserOptions: {
        linkify: true, // فعال کردن لینک خودکار
        plugins: [
          window.markdownitFootnote, // افزونه پاورقی
          [window.markdownitSub, {}] // افزونه زیرنویس با تنظیمات
        ]
      }
    }
    ```
> برای اطلاعات کامل در مورد ساخت و استفاده از مفسرهای سفارشی، به **[مستندات مفسر مارک‌داون](./parsers.md)** مراجعه کنید.

### `font`
این بخش جدید به شما اجازه می‌دهد تا فونت‌ها و تایپوگرافی کلی سایت را مدیریت کنید.

-   `baseSize`: اندازه پایه فونت برای کل سایت (مثلاً `'16px'`).
-   `lineHeight`: ضریب ارتفاع خط برای خوانایی بهتر (مثلاً `1.7`).
-   `custom`: یک آبجکت برای تعریف و فعال‌سازی فونت سفارشی.
    -   `enabled`: اگر `true` باشد، شیرازه تلاش می‌کند فونت تعریف شده توسط شما را بارگذاری کند.
    -   `path`: مسیر فایل CSS که `@font-face` های شما را تعریف می‌کند. (مثال: `'config/fonts/fonts.css'`)
    -   `family`: نام خانواده فونت اصلی (`font-family`) برای متن‌ها.
    -   `codeFamily`: نام خانواده فونت برای بلوک‌های کد.

-   **مقدار پیش‌فرض:**
    ```javascript
    font: {
      baseSize: '16px',
      lineHeight: 1.7,
      custom: {
        enabled: false,
        path: 'config/fonts/fonts.css',
        family: '',
        codeFamily: ''
      }
    }
    ```
-   **مثال (برای استفاده از فونت سفارشی ایران‌سنس):**
    ```javascript
    // 1. فایل‌های فونت و فایل `fonts.css` را در `config/fonts/` قرار دهید.
    // 2. تنظیمات زیر را اعمال کنید:
    font: {
      baseSize: '17px',
      lineHeight: 1.8,
      custom: {
        enabled: true,
        path: 'config/fonts/fonts.css',
        family: 'IRANSansX',
        codeFamily: 'Fira Code VF'
      }
    }
    ```
> اگر فونت سفارشی فعال باشد اما فایل‌ها پیدا نشوند، شیرازه به صورت خودکار به فونت پیش‌فرض (وزیرمتن) بازمی‌گردد.

### `title`
این بخش جدید، رفتار عنوان تب مرورگر (`<title>`) را کنترل می‌کند.

-   `enabled`: فعال یا غیرفعال کردن سیستم عنوان هوشمند.
-   `includeWiki`: اگر `true` باشد، نام ویکی (`appName`) نیز به عنوان صفحه اضافه می‌شود.
-   `order`: ترتیب نمایش عنوان صفحه و نام ویکی را مشخص می‌کند.
    -   `'page-first'`: (پیش‌فرض) `نام صفحه | نام ویکی`
    -   `'wiki-first'`: `نام ویکی | نام صفحه`
    -   `'page-only'`: فقط نام صفحه نمایش داده می‌شود.
-   `separator`: نویسه جداکننده بین نام صفحه و نام ویکی (پیش‌فرض: `' | '`).
-   `fallback`: متنی که اگر هیچ منبعی برای عنوان پیدا نشد، نمایش داده می‌شود.

-   **مقدار پیش‌فرض:**
    ```javascript
    title: {
      enabled: true,
      includeWiki: true,
      order: 'page-first',
      separator: ' | ',
      fallback: 'بدون عنوان'
    }
    ```
-   **مثال (نمایش عنوان به صورت `نام ویکی - نام صفحه`):**
    ```javascript
    title: {
      order: 'wiki-first',
      separator: ' - '
    }
    ```
> **نکته:** برای بهترین نتیجه، می‌توانید به لینک‌های خود در `sidebar.md` یک `title` اضافه کنید: `[متن لینک](/path "این متن به عنوان عنوان صفحه استفاده می‌شود")`.

### `selectors`

این گزینه‌ها شناسه‌های CSS برای المان‌های اصلی برنامه هستند که به صورت پویا ساخته می‌شوند. **تغییر این مقادیر توصیه نمی‌شود** مگر اینکه منطق ساخت چیدمان در فایل `src/core/app.js` را نیز تغییر دهید.

-   **مقدار پیش‌فرض:**
    ```javascript
    selectors: {
      root: '#app',
      content: '.content',
      sidebarNav: '.sidebar-nav',
      sidebarToggle: '.sidebar-toggle',
    }
    ```

### `sidebar`

تنظیمات مربوط به رفتار منوی کناری.

-   `enabled`: مشخص می‌کند که آیا منوی کناری نمایش داده شود یا خیر. اگر آن را `false` کنید، منو و دکمه آن به طور کامل پنهان می‌شوند.

-   **مقدار پیش‌فرض:**
    ```javascript
    sidebar: {
      enabled: true,
    }
    ```

### `theme`

این بخش به شما اجازه می‌دهد تا ظاهر ویکی را شخصی‌سازی کنید.

-   `default`: تم پیش‌فرض هنگام اولین بازدید کاربر را مشخص می‌کند.
    -   `'auto'`: به طور خودکار تم سیستم‌عامل کاربر را تشخیص می‌دهد (پیش‌فرض).
    -   `'light'`: همیشه با تم روشن شروع می‌شود.
    -   `'dark'`: همیشه با تم تاریک شروع می‌شود.
    > توجه: پس از اولین بازدید، انتخاب کاربر در حافظه مرورگر ذخیره شده و بر این تنظیم اولویت خواهد داشت.

-   **بازنویسی رنگ‌ها:** شما می‌توانید مقادیر متغیرهای رنگی CSS را مستقیماً از اینجا بازنویسی کنید. این تغییرات هم بر تم روشن و هم بر تم تاریک اعمال می‌شوند. برای مشاهده لیست کامل متغیرها و راهنمای ساخت تم سفارشی، به **[مستندات تم‌بندی](./theming.md)** مراجعه کنید.

-   **مقدار پیش‌فرض:**
    ```javascript
    theme: {
      default: 'auto',
    }
    ```
-   **مثال (برای شروع با تم تاریک و تغییر رنگ اصلی به بنفش):**
    ```javascript
    theme: {
      default: 'dark',
      primaryColor: '#a78bfa', // رنگ اصلی (بنفش)
      sidebarBg: '#1e1b4b',      // پس‌زمینه سایدبار (سرمه‌ای تیره)
    }
    ```

### `remote`

این بخش تنظیمات مربوط به بارگذاری محتوای مارک‌داون از URLهای خارجی (مثلاً از یک مخزن گیت‌هاب) را کنترل می‌کند.

-   `enabled`:
    -   **نوع:** `boolean`
    -   **مقدار پیش‌فرض:** `false`
    -   **توضیحات:** اگر `true` باشد، شیرازه قادر خواهد بود فایل‌های مارک‌داون را از هر URL معتبری در اینترنت بارگذاری کند. در این حالت، لینک‌های کامل (مانند `https://...`) در `sidebar.md` به عنوان صفحات داخلی در نظر گرفته می‌شوند. اگر `false` باشد، این قابلیت غیرفعال شده و لینک‌های خارجی در یک تب جدید باز می‌شوند.

-   `corsProxyUrl`:
    -   **نوع:** `string`
    -   **مقدار پیش‌فرض:** `''`
    -   **توضیحات:** به دلیل محدودیت‌های امنیتی مرورگرها (CORS)، یک صفحه وب نمی‌تواند مستقیماً از یک دامنه دیگر محتوا دریافت کند، مگر اینکه آن دامنه اجازه صریحی صادر کرده باشد. اگر سرور خارجی (مثلاً گیت‌هاب) این اجازه را ندهد، درخواست با خطا مواجه می‌شود. برای حل این مشکل، می‌توان از یک **پروکسی CORS** استفاده کرد. این پروکسی یک واسطه است که درخواست شما را دریافت کرده، محتوای URL اصلی را واکشی می‌کند و با هدرهای صحیح به شیرازه باز می‌گرداند.
    -   **مثال:**
        ```javascript
        remote: {
          enabled: true,
          // استفاده از یک پروکسی عمومی
          corsProxyUrl: 'https://api.allorigins.win/raw?url='
        }
        ```
    > **نکته:** اگر سروری که محتوای شما را میزبانی می‌کند، هدر `Access-Control-Allow-Origin: *` را ارسال کند، نیازی به استفاده از پروکسی نخواهید داشت و می‌توانید این فیلد را خالی بگذارید.

> **نکته مهم:** پس از هر تغییر در فایل `config.js`، کافیست صفحه مرورگر را رفرش کنید تا تغییرات اعمال شوند. نیازی به اجرای مجدد سرور نیست.